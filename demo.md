# 分布式PBFT共识系统演示

## 演示场景

本演示将展示如何使用分布式PBFT共识系统进行多人参与的共识过程。

## 准备工作

1. **启动系统**
   ```bash
   cd distributed-pbft
   ./start.sh
   ```

2. **准备设备**
   - 主控设备：用于创建会话和生成二维码
   - 参与设备：至少3台设备（手机、平板、电脑等）

## 演示步骤

### 第一步：创建共识会话

1. 在主控设备上访问 `http://localhost:3000`
2. 配置共识参数：
   - 节点总数：6
   - 容错节点数：1
   - 拓扑结构：全连接
   - 提议值：0
   - 恶意提议者：关闭
   - 允许消息篡改：关闭
3. 点击"创建共识会话"
4. 系统会生成二维码和节点链接

### 第二步：加入节点

**方法一：扫描二维码**
1. 在其他设备上扫描生成的二维码
2. 自动跳转到加入页面
3. 选择要扮演的节点（建议选择不同的节点）

**方法二：直接访问链接**
1. 复制主控页面上的节点链接
2. 在其他设备上打开链接
3. 选择要扮演的节点

### 第三步：参与共识过程

1. **等待连接**
   - 所有节点连接后，系统自动开始共识
   - 观察节点状态变化

2. **预准备阶段**
   - 提议者（节点0）自动发送提议
   - 其他节点接收并验证提议

3. **准备阶段**
   - 每个节点点击"发送准备消息"
   - 观察消息传递过程

4. **提交阶段**
   - 每个节点点击"发送提交消息"
   - 观察最终共识结果

## 演示要点

### 1. 实时通信
- 观察消息的实时传递
- 注意消息的时间戳和来源

### 2. 节点状态
- 查看连接状态变化
- 观察共识进度条

### 3. 网络拓扑
- 观察节点间的连接关系
- 理解不同拓扑结构的影响

### 4. 容错机制
- 尝试断开某个节点
- 观察系统如何继续运行

## 高级演示

### 恶意节点演示
1. 创建新会话时开启"恶意提议者"
2. 观察提议者可能发送错误值
3. 验证系统是否能正确达成共识

### 消息篡改演示
1. 创建新会话时开启"允许消息篡改"
2. 观察故障节点如何篡改消息
3. 验证系统的容错能力

### 不同拓扑演示
1. 尝试不同的拓扑结构（环形、星形、树形）
2. 观察消息传递路径的变化
3. 比较不同拓扑的优缺点

## 故障排除

### 常见问题

1. **节点无法连接**
   - 检查网络连接
   - 确认后端服务正在运行
   - 检查防火墙设置

2. **二维码无法扫描**
   - 确保设备在同一网络
   - 尝试直接访问链接
   - 检查IP地址配置

3. **共识无法开始**
   - 确保所有节点都已连接
   - 检查节点数量配置
   - 查看浏览器控制台错误

### 调试技巧

1. **查看控制台日志**
   - 打开浏览器开发者工具
   - 观察WebSocket连接状态
   - 查看错误信息

2. **检查网络状态**
   - 使用网络监控工具
   - 观察消息传递延迟
   - 检查连接稳定性

## 扩展实验

### 1. 性能测试
- 增加节点数量
- 测量共识时间
- 分析网络开销

### 2. 安全性测试
- 模拟各种攻击场景
- 测试容错边界
- 验证共识正确性

### 3. 用户体验优化
- 收集用户反馈
- 优化界面设计
- 改进交互流程

## 总结

通过这个演示，参与者可以：
- 理解PBFT算法的基本原理
- 体验分布式共识的实际过程
- 观察容错机制的工作方式
- 学习分布式系统的设计思路

这个系统为区块链和分布式系统的教学和研究提供了很好的实践平台。 