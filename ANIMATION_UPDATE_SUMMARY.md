# åŠ¨ç”»æ¼”ç¤ºåŠŸèƒ½æ›´æ–°æ€»ç»“

## âœ¨ ä¸»è¦æ”¹è¿›

### 1. çœŸå®ä¼šè¯å†å²å›æ”¾
ç°åœ¨åŠ¨ç”»æ¼”ç¤ºåŠŸèƒ½å¯ä»¥**å±•ç¤ºçœŸå®ä¼šè¯ä¸­å®é™…å‘é€çš„æ¶ˆæ¯**ï¼Œè€Œä¸ä»…ä»…æ˜¯æ¨¡æ‹Ÿæ•°æ®ã€‚

#### æ ¸å¿ƒç‰¹æ€§
- âœ… **çœŸå®æ¶ˆæ¯å±•ç¤º**ï¼šæ¯ä¸ªå°çƒä»£è¡¨ä¸€æ¡çœŸå®å‘é€çš„æ¶ˆæ¯
- âœ… **äººç±»èŠ‚ç‚¹è¡Œä¸ºè¿½è¸ª**ï¼šå‡†ç¡®åæ˜ äººç±»èŠ‚ç‚¹æ˜¯å¦çœŸçš„å‘é€äº†æ¶ˆæ¯
- âœ… **æ‹œå åº­æ”»å‡»å¯è§†åŒ–**ï¼šé”™è¯¯æ¶ˆæ¯ç”¨çº¢è‰²åœ†åœˆæ ‡è®°
- âœ… **æœºå™¨äººèŠ‚ç‚¹è¡Œä¸º**ï¼šå±•ç¤ºæœºå™¨äººèŠ‚ç‚¹æŒ‰è§„åˆ™å‘é€çš„æ¶ˆæ¯
- âœ… **åªæ˜¾ç¤ºå®é™…å‘é€çš„æ¶ˆæ¯**ï¼šæ²¡æœ‰å‘é€çš„æ¶ˆæ¯ä¸ä¼šæ˜¾ç¤º

### 2. æ™ºèƒ½æ¶ˆæ¯é¢œè‰²åˆ¤æ–­
åŠ¨ç”»æ ¹æ®æ¶ˆæ¯çš„å®é™…valueå€¼æ¥åˆ¤æ–­é¢œè‰²ï¼š
- ğŸŸ¢ **ç»¿è‰²æ¶ˆæ¯**ï¼švalueä¸proposalValueç›¸åŒï¼ˆæ­£ç¡®çš„æ¶ˆæ¯ï¼‰
- ğŸ”´ **çº¢è‰²æ¶ˆæ¯**ï¼švalueä¸proposalValueä¸åŒï¼ˆæ‹œå åº­æ”»å‡»ï¼‰

### 3. ä¸¤ç§æ¼”ç¤ºæ¨¡å¼
ç³»ç»Ÿä¼šæ™ºèƒ½åˆ¤æ–­ä½¿ç”¨å“ªç§æ¨¡å¼ï¼š

#### çœŸå®ä¼šè¯æ¨¡å¼
- å½“å·²ç»åˆ›å»ºä¼šè¯æ—¶è‡ªåŠ¨å¯ç”¨
- æ˜¾ç¤ºçœŸå®çš„æ¶ˆæ¯å†å²è®°å½•
- ç•Œé¢æ ‡è®°ï¼š**"çœŸå®ä¼šè¯æ¶ˆæ¯å†å²"**ï¼ˆç»¿è‰²æ ‡ç­¾ï¼‰
- åªæœ‰1è½®ï¼ˆå½“å‰ä¼šè¯çš„æ•°æ®ï¼‰

#### æ¨¡æ‹Ÿæ¼”ç¤ºæ¨¡å¼
- å½“æœªåˆ›å»ºä¼šè¯æ—¶è‡ªåŠ¨å¯ç”¨
- ç”Ÿæˆ3è½®æ¨¡æ‹Ÿæ•°æ®
- ç•Œé¢æ ‡è®°ï¼š**"æ¨¡æ‹Ÿæ¼”ç¤ºæ•°æ®"**ï¼ˆè“è‰²æ ‡ç­¾ï¼‰
- å¯åˆ‡æ¢æŸ¥çœ‹3ä¸ªä¸åŒè½®æ¬¡

## ğŸ”§ æŠ€æœ¯å®ç°

### åç«¯æ”¹è¿›

#### æ–°å¢APIï¼š`/api/sessions/{session_id}/history`
```python
@app.get("/api/sessions/{session_id}/history")
async def get_session_history(session_id: str):
    """è·å–ä¼šè¯çš„çœŸå®æ¶ˆæ¯å†å²ï¼Œç”¨äºåŠ¨ç”»æ¼”ç¤º"""
```

**åŠŸèƒ½**ï¼š
1. è¯»å–ä¼šè¯ä¸­å­˜å‚¨çš„çœŸå®æ¶ˆæ¯
2. å°†å¹¿æ’­æ¶ˆæ¯ï¼ˆto: "all"ï¼‰å±•å¼€ä¸ºç‚¹å¯¹ç‚¹æ¶ˆæ¯
3. æ ¹æ®æ‹“æ‰‘ç»“æ„è¿‡æ»¤è¿æ¥å…³ç³»
4. ä¿ç•™æ¶ˆæ¯çš„çœŸå®valueå€¼

**æ¶ˆæ¯å±•å¼€é€»è¾‘**ï¼š
```python
# ç¤ºä¾‹ï¼šèŠ‚ç‚¹0å‘é€å¹¿æ’­æ¶ˆæ¯
{
  "from": 0,
  "to": "all",
  "value": 1,  # å¯èƒ½æ˜¯æ‹œå åº­æ”»å‡»çš„é”™è¯¯å€¼
  "type": "prepare"
}

# å±•å¼€ä¸ºå¤šæ¡ç‚¹å¯¹ç‚¹æ¶ˆæ¯ï¼ˆæ ¹æ®æ‹“æ‰‘ç»“æ„ï¼‰
[
  {"src": 0, "dst": 1, "value": 1, "type": "prepare"},
  {"src": 0, "dst": 2, "value": 1, "type": "prepare"},
  {"src": 0, "dst": 3, "value": 1, "type": "prepare"},
  ...
]
```

### å‰ç«¯æ”¹è¿›

#### HomePage.vue ä¿®æ”¹
```javascript
const showDemo = async () => {
  // æ™ºèƒ½åˆ¤æ–­ä½¿ç”¨å“ªç§æ¨¡å¼
  if (sessionInfo.value) {
    // åœºæ™¯Aï¼šçœŸå®ä¼šè¯æ¨¡å¼
    const response = await axios.get(`/api/sessions/${sessionInfo.value.sessionId}/history`)
    simulationRounds.value.push({
      id: 1,
      data: response.data,
      isReal: true  // æ ‡è®°ä¸ºçœŸå®æ•°æ®
    })
  } else {
    // åœºæ™¯Bï¼šæ¨¡æ‹Ÿæ¼”ç¤ºæ¨¡å¼
    for (let i = 1; i <= 3; i++) {
      const response = await axios.post('/api/simulate', {...})
      simulationRounds.value.push({
        id: i,
        data: response.data,
        isReal: false  // æ ‡è®°ä¸ºæ¨¡æ‹Ÿæ•°æ®
      })
    }
  }
}
```

#### Topology.vue ä¿®æ”¹
```javascript
// æ™ºèƒ½åˆ¤æ–­æ¶ˆæ¯é¢œè‰²
const expectedValue = props.proposalValue ?? props.simulationResult?.proposalValue ?? 0;
const dotColor = (anim.msg.value === expectedValue || 
                anim.msg.value === expectedValue.toString())
    ? "green"  // æ­£ç¡®çš„æ¶ˆæ¯
    : "red";   // æ‹œå åº­æ”»å‡»çš„é”™è¯¯æ¶ˆæ¯
```

## ğŸ“Š ä½¿ç”¨åœºæ™¯å¯¹æ¯”

| åœºæ™¯ | ä½¿ç”¨çœŸå®å†å² | ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ® |
|------|------------|------------|
| **ä½•æ—¶ä½¿ç”¨** | åˆ›å»ºä¼šè¯åæƒ³æŸ¥çœ‹å®é™…è¿‡ç¨‹ | æ²¡æœ‰ä¼šè¯æ—¶æƒ³æ¼”ç¤ºç®—æ³• |
| **æ•°æ®æ¥æº** | çœŸå®æ¶ˆæ¯è®°å½• | ç®—æ³•è‡ªåŠ¨ç”Ÿæˆ |
| **æ¶ˆæ¯å‡†ç¡®æ€§** | 100%çœŸå® | ç†æƒ³æƒ…å†µæ¨¡æ‹Ÿ |
| **äººç±»èŠ‚ç‚¹** | æ˜¾ç¤ºå®é™…è¡Œä¸º | å‡è®¾éƒ½æ­£å¸¸å‘é€ |
| **æ‹œå åº­æ”»å‡»** | çœŸå®æ”»å‡»è¡Œä¸º | æ¨¡æ‹Ÿæ”»å‡» |
| **è½®æ¬¡æ•°é‡** | 1è½® | 3è½® |
| **é€‚ç”¨å¯¹è±¡** | å‚ä¸è¿‡å…±è¯†çš„ç”¨æˆ· | å­¦ä¹ ç®—æ³•çš„æ–°æ‰‹ |

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šæŸ¥çœ‹çœŸå®å…±è¯†è¿‡ç¨‹

```bash
# 1. åˆ›å»ºä¼šè¯
ç”¨æˆ·A: åœ¨ä¸»é¡µé…ç½®å‚æ•°ï¼Œç‚¹å‡»"åˆ›å»ºå…±è¯†ä¼šè¯"

# 2. åŠ å…¥èŠ‚ç‚¹ï¼ˆå¤šä¸ªç”¨æˆ·ï¼‰
ç”¨æˆ·B: æ‰«æäºŒç»´ç ï¼ŒåŠ å…¥èŠ‚ç‚¹1
ç”¨æˆ·C: æ‰«æäºŒç»´ç ï¼ŒåŠ å…¥èŠ‚ç‚¹2
...

# 3. å‚ä¸å…±è¯†
- æ‰€æœ‰ç”¨æˆ·å‘é€å‡†å¤‡æ¶ˆæ¯
- ç”¨æˆ·C é€‰æ‹©æ‹œå åº­æ”»å‡»ï¼Œå‘é€é”™è¯¯å€¼
- æ‰€æœ‰ç”¨æˆ·å‘é€æäº¤æ¶ˆæ¯

# 4. æŸ¥çœ‹åŠ¨ç”»å›æ”¾
ç”¨æˆ·A: ç‚¹å‡»"åŠ¨ç”»æ¼”ç¤ºå…±è¯†è¿‡ç¨‹"
ç»“æœ:
  âœ… çœ‹åˆ°ç»¿è‰²æ ‡ç­¾ "çœŸå®ä¼šè¯æ¶ˆæ¯å†å²"
  âœ… åŠ¨ç”»æ˜¾ç¤ºæ‰€æœ‰å®é™…å‘é€çš„æ¶ˆæ¯
  ğŸ”´ ç”¨æˆ·Cçš„é”™è¯¯æ¶ˆæ¯æ˜¾ç¤ºä¸ºçº¢è‰²åœ†åœˆ
  âœ… å¦‚æœæœ‰èŠ‚ç‚¹æ²¡å‘é€æ¶ˆæ¯ï¼Œä¸ä¼šæ˜¾ç¤ºé‚£æ¡æ¶ˆæ¯
```

### ç¤ºä¾‹2ï¼šæ•™å­¦æ¼”ç¤º

```bash
# 1. ä¸åˆ›å»ºä¼šè¯ï¼Œç›´æ¥æ¼”ç¤º
æ•™å¸ˆ: é…ç½®å‚æ•°ï¼ˆ6ä¸ªèŠ‚ç‚¹ï¼Œ1ä¸ªæ‹œå åº­èŠ‚ç‚¹ï¼‰
æ•™å¸ˆ: ç‚¹å‡»"åŠ¨ç”»æ¼”ç¤ºå…±è¯†è¿‡ç¨‹"

ç»“æœ:
  âœ… çœ‹åˆ°è“è‰²æ ‡ç­¾ "æ¨¡æ‹Ÿæ¼”ç¤ºæ•°æ®"
  âœ… è‡ªåŠ¨ç”Ÿæˆ3è½®ä¸åŒçš„å…±è¯†è¿‡ç¨‹
  âœ… å¯åˆ‡æ¢è½®æ¬¡æŸ¥çœ‹ä¸åŒæƒ…å†µ
  âœ… æ‰€æœ‰æ¶ˆæ¯éƒ½ä¼šæ˜¾ç¤ºï¼ˆç†æƒ³æ¨¡æ‹Ÿï¼‰
```

## ğŸ” å…³é”®å·®å¼‚è¯´æ˜

### çœŸå®å†å² vs æ¨¡æ‹Ÿæ•°æ®

#### çœŸå®å†å²çš„ç‰¹ç‚¹
```
Pre-Prepareé˜¶æ®µ:
  âœ“ èŠ‚ç‚¹0å‘é€æè®® â†’ æ˜¾ç¤ºåŠ¨ç”»
  
Prepareé˜¶æ®µ:
  âœ“ èŠ‚ç‚¹0å‘é€å‡†å¤‡æ¶ˆæ¯ â†’ æ˜¾ç¤ºåŠ¨ç”»
  âœ“ èŠ‚ç‚¹1å‘é€å‡†å¤‡æ¶ˆæ¯ â†’ æ˜¾ç¤ºåŠ¨ç”»
  âœ— èŠ‚ç‚¹2æ²¡æœ‰å‘é€ï¼ˆäººç±»èŠ‚ç‚¹å¿˜è®°ç‚¹å‡»ï¼‰â†’ ä¸æ˜¾ç¤º
  âœ“ èŠ‚ç‚¹3å‘é€é”™è¯¯å€¼ï¼ˆæ‹œå åº­æ”»å‡»ï¼‰â†’ æ˜¾ç¤ºçº¢è‰²åŠ¨ç”»
  âœ“ èŠ‚ç‚¹4å‘é€å‡†å¤‡æ¶ˆæ¯ â†’ æ˜¾ç¤ºåŠ¨ç”»
  âœ“ èŠ‚ç‚¹5å‘é€å‡†å¤‡æ¶ˆæ¯ â†’ æ˜¾ç¤ºåŠ¨ç”»
```

#### æ¨¡æ‹Ÿæ•°æ®çš„ç‰¹ç‚¹
```
Pre-Prepareé˜¶æ®µ:
  âœ“ èŠ‚ç‚¹0å‘é€æè®® â†’ æ˜¾ç¤ºåŠ¨ç”»
  
Prepareé˜¶æ®µ:
  âœ“ æ‰€æœ‰èŠ‚ç‚¹éƒ½å‘é€æ¶ˆæ¯ â†’ å…¨éƒ¨æ˜¾ç¤ºåŠ¨ç”»
  âœ“ æ‹œå åº­èŠ‚ç‚¹æŒ‰è§„åˆ™å‘é€é”™è¯¯å€¼ â†’ æ˜¾ç¤ºçº¢è‰²åŠ¨ç”»
```

## ğŸ¨ ç•Œé¢è¯´æ˜

### çœŸå®ä¼šè¯æ¨¡å¼ç•Œé¢
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [çœŸå®ä¼šè¯æ¶ˆæ¯å†å²] ğŸŸ¢                    â”‚
â”‚                                         â”‚
â”‚  [é‡æ–°æ’­æ”¾åŠ¨ç”»] æŒ‰é’®                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¨¡æ‹Ÿæ¼”ç¤ºæ¨¡å¼ç•Œé¢
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [æ¨¡æ‹Ÿæ¼”ç¤ºæ•°æ®] ğŸ”µ                         â”‚
â”‚                                         â”‚
â”‚  é€‰æ‹©æ¼”ç¤ºè½®æ¬¡:                             â”‚
â”‚  âšª ç¬¬1è½®  âšª ç¬¬2è½®  âšª ç¬¬3è½®              â”‚
â”‚                                         â”‚
â”‚  [é‡æ–°æ’­æ”¾åŠ¨ç”»] æŒ‰é’®                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ æ³¨æ„äº‹é¡¹

### æ¶ˆæ¯æ˜¾ç¤ºè§„åˆ™
1. âœ… **æœºå™¨äººèŠ‚ç‚¹**ï¼šæŒ‰è§„åˆ™è‡ªåŠ¨å‘é€ï¼Œä¸€å®šä¼šæ˜¾ç¤º
2. âš ï¸ **äººç±»èŠ‚ç‚¹**ï¼šåªæ˜¾ç¤ºå®é™…å‘é€çš„æ¶ˆæ¯
3. ğŸ”´ **é”™è¯¯æ¶ˆæ¯**ï¼šä¸proposalValueä¸åŒçš„æ¶ˆæ¯æ˜¾ç¤ºä¸ºçº¢è‰²
4. ğŸŸ¢ **æ­£ç¡®æ¶ˆæ¯**ï¼šä¸proposalValueç›¸åŒçš„æ¶ˆæ¯æ˜¾ç¤ºä¸ºç»¿è‰²

### æ‹“æ‰‘ç»“æ„å½±å“
- åŠ¨ç”»ä¼šæ ¹æ®æ‹“æ‰‘ç»“æ„åªæ˜¾ç¤ºå…è®¸çš„è¿æ¥
- ä¾‹å¦‚ï¼šç¯å½¢æ‹“æ‰‘ä¸­ï¼ŒèŠ‚ç‚¹åªä¼šå‘ç›¸é‚»èŠ‚ç‚¹å‘é€æ¶ˆæ¯
- æ˜Ÿå½¢æ‹“æ‰‘ä¸­ï¼Œæ¶ˆæ¯åªåœ¨ä¸­å¿ƒèŠ‚ç‚¹å’Œå¤–å›´èŠ‚ç‚¹é—´ä¼ é€’

### æ€§èƒ½è€ƒè™‘
- çœŸå®å†å²æ¨¡å¼ï¼šæ¶ˆæ¯æ•°é‡å–å†³äºå®é™…å‘é€æƒ…å†µï¼Œå¯èƒ½è¾ƒå°‘
- æ¨¡æ‹Ÿæ¼”ç¤ºæ¨¡å¼ï¼šæ¶ˆæ¯æ•°é‡æ˜¯ç†è®ºæœ€å¤§å€¼ï¼ŒèŠ‚ç‚¹å¤šæ—¶å¯èƒ½å¡é¡¿

## ğŸš€ å¯åŠ¨æµ‹è¯•

### æ–¹å¼1ï¼šæµ‹è¯•çœŸå®å†å²
```bash
# 1. å¯åŠ¨æœåŠ¡
./start.sh

# 2. åˆ›å»ºä¼šè¯å¹¶è®©å¤šä¸ªèŠ‚ç‚¹å‚ä¸

# 3. ç‚¹å‡»"åŠ¨ç”»æ¼”ç¤ºå…±è¯†è¿‡ç¨‹"æŸ¥çœ‹çœŸå®å†å²
```

### æ–¹å¼2ï¼šæµ‹è¯•æ¨¡æ‹Ÿæ¼”ç¤º
```bash
# 1. å¯åŠ¨æœåŠ¡
./start.sh

# 2. ç›´æ¥åœ¨ä¸»é¡µé…ç½®å‚æ•°

# 3. ä¸åˆ›å»ºä¼šè¯ï¼Œç›´æ¥ç‚¹å‡»"åŠ¨ç”»æ¼”ç¤ºå…±è¯†è¿‡ç¨‹"
```

## ğŸ“¦ ä¿®æ”¹çš„æ–‡ä»¶

### åç«¯
- âœ… `/backend/main.py` - æ·»åŠ å†å²APIï¼Œä¿®æ”¹æ¶ˆæ¯å±•å¼€é€»è¾‘

### å‰ç«¯
- âœ… `/src/views/HomePage.vue` - æ™ºèƒ½æ¨¡å¼é€‰æ‹©
- âœ… `/src/components/Topology.vue` - é¢œè‰²åˆ¤æ–­é€»è¾‘
- âœ… `/vite.config.js` - æ·»åŠ è·¯å¾„åˆ«å

### æ–‡æ¡£
- âœ… `ANIMATION_DEMO_GUIDE.md` - æ›´æ–°ä½¿ç”¨æŒ‡å—
- âœ… `ANIMATION_UPDATE_SUMMARY.md` - æœ¬æ–‡æ¡£

## âœ… å®ŒæˆçŠ¶æ€

- [x] åç«¯æ·»åŠ å†å²API
- [x] æ¶ˆæ¯å±•å¼€é€»è¾‘ï¼ˆå¹¿æ’­â†’ç‚¹å¯¹ç‚¹ï¼‰
- [x] å‰ç«¯æ™ºèƒ½æ¨¡å¼é€‰æ‹©
- [x] é¢œè‰²åˆ¤æ–­é€»è¾‘ä¼˜åŒ–
- [x] ç•Œé¢æ ‡ç­¾å’Œæç¤º
- [x] æ–‡æ¡£æ›´æ–°
- [x] viteé…ç½®ä¿®å¤

---

**æ›´æ–°æ—¥æœŸ**ï¼š2025-11-02  
**ç‰ˆæœ¬**ï¼š2.0.0  
**ä½œè€…**ï¼šåˆ†å¸ƒå¼PBFTå…±è¯†ç³»ç»Ÿå›¢é˜Ÿ

